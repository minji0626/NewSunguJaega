<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <title>Kakao 지도 예제</title>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; margin: 0; padding: 20px; background: #f6f7fb; }
        h1 { margin: 0 0 12px; }
        #map { width: 100%; max-width: 720px; height: 420px; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.08); overflow: hidden; }
        .note { margin-top: 12px; color: #555; line-height: 1.6; }
        code { background: #eef2ff; padding: 2px 6px; border-radius: 6px; }
    </style>
</head>
<body>
    <h1>카카오 지도 로딩 예제</h1>
    <div id="map" role="region" aria-label="지도"></div>
    <p id="map-status" class="note" style="display:none;"></p>
    <p class="note">
        아래 코드는 <code>DOMContentLoaded</code> 이후에 지도 컨테이너를 찾고, Kakao SDK가 로드된 다음 <code>kakao.maps.load</code> 안에서 지도를 초기화합니다.<br>
        사용 중인 앱 키가 등록된 도메인(예: <code>http://localhost:포트</code>)에서 열어야 지도가 정상적으로 표시됩니다.<br><br>
        <strong>앱 키 설정 방법</strong><br>
        1) <code>const appKey = "YOUR_APP_KEY_HERE";</code>를 발급받은 JavaScript 키로 바꿉니다.<br>
        2) 카카오 개발자 콘솔 &gt; 내 애플리케이션 &gt; 플랫폼에서 이 페이지를 여는 호스트(<code><script>document.write(location.protocol + "//" + location.host)</script></code>)를 허용 도메인에 추가합니다.<br>
        3) 저장 후 페이지를 새로고침하면 지도 스크립트 로드 오류 안내가 사라집니다.
    </p>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const container = document.getElementById("map");
            const status = document.getElementById("map-status");
            const appKey = "YOUR_APP_KEY_HERE"; // 발급받은 앱 키로 교체 후, 허용 도메인에서 실행하세요.

            const showMessage = (message) => {
                if (status) {
                    status.textContent = message;
                    status.style.display = "block";
                } else {
                    alert(message);
                }
            };

            if (!container) return;

            if (location.protocol === "file:") {
                showMessage("file:// 경로에서는 앱 키 도메인 검증 때문에 SDK가 로드되지 않습니다. 간단한 로컬 서버(http://localhost:포트)에서 열어주세요.");
                return;
            }

            if (!appKey || appKey === "YOUR_APP_KEY_HERE") {
                showMessage("Kakao 앱 키를 설정하세요. appKey 변수에 발급받은 키를 입력하고, 허용 도메인 목록에 현재 호스트를 추가해야 합니다.");
                return;
            }

            const loadSdk = () => {
                const script = document.createElement("script");
                script.src = `https://dapi.kakao.com/v2/maps/sdk.js?autoload=false&libraries=services&appkey=${appKey}`;
                script.async = true;
                script.defer = true;
                script.onload = initMap;
                script.onerror = () => showMessage("지도 스크립트 로드에 실패했습니다. 앱 키와 도메인을 확인하세요.");
                document.head.appendChild(script);
            };

            const initMap = () => {
                if (!window.kakao?.maps) return;
                kakao.maps.load(() => {
                    const coords = new kakao.maps.LatLng(33.450701, 126.570667);
                    const map = new kakao.maps.Map(container, { center: coords, level: 3 });
                    const marker = new kakao.maps.Marker({ position: coords });
                    marker.setMap(map);
                });
            };

            loadSdk();
        });
    </script>
</body>
</html>
